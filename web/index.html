<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"
        integrity="sha512-d9xgZrVZpmmQlfonhQUvTR7lMPtO7NkZMkA0ABN3PHCbKA5nqylQ/yWlFAyY6hYgdF1Qh6nYiuADWwKB4C2WSw=="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.js"
        integrity="sha512-zO8oeHCxetPn1Hd9PdDleg5Tw1bAaP0YmNvPY8CwcRyUk7d7/+nyElmFrB6f7vg4f7Fv4sui1mcep8RIEShczg=="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js"
        integrity="sha512-SuxO9djzjML6b9w9/I07IWnLnQhgyYVSpHZx0JV97kGBfTIsUYlWflyuW4ypnvhBrslz1yJ3R+S14fdCWmSmSA=="
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.css"
        integrity="sha512-C7hOmCgGzihKXzyPU/z4nv97W0d9bv4ALuuEbSf6hm93myico9qa0hv4dODThvCsqQUmKmLcJmlpRmCaApr83g=="
        crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"
        integrity="sha512-hZf9Qhp3rlDJBvAKvmiG+goaaKRZA6LKUO35oK6EsM0/kjPK32Yw7URqrq3Q+Nvbbt8Usss+IekL7CRn83dYmw=="
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.css"
        integrity="sha512-/zs32ZEJh+/EO2N1b0PEdoA10JkdC3zJ8L5FTiQu82LR9S/rOQNfQN7U59U9BC12swNeRAz3HSzIL2vpp4fv3w=="
        crossorigin="anonymous" />
</head>

<body>
    <canvas id="myChart" width="400" height="400"></canvas>
    <script>
        var limit=320;
        var count=0;
	var H=[];
var T=[];
var HIT=[];
var light=[];
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                // Typical action to be performed when the document is ready:
                console.log(xhttp.responseText);
		console.log(typeof(xhttp.responseText))	
		    tmp=""
		    for(var i=0;i<xhttp.responseText.length-4;i++)
			    tmp+=xhttp.responseText[i]

		    tmp+="}]}"
                tmp=tmp.replace(/\'/g, "\""); //response not changeable?

			// need to do this when save
		    var obj=JSON.parse(tmp)["dataset"];
		for(var i=0;i<obj.length;i++)
		    {
			    H.push(obj[i].humidity);
			    T.push(obj[i].temp);
		    }

		    count++;
                if(count>=limit)
                {
			var ctx = document.getElementById('myChart');
		   var myLineChart = new Chart(ctx, {
    type: 'line',
			   data: 
			   {datasets:[{data:T}]}}); 
                    return;
                }
                else{
                    xhttp.open("GET", "/python/jsons/"+String(count+2)+".json", true);
                    xhttp.send();
                }
            }
        };
        
        xhttp.open("GET", "/python/jsons/1.json", true);
        xhttp.send();
    </script>
</body>

</html>
